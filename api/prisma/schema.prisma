generator client {
  provider = "prisma-client-js"
}

generator nestgraphql {
  provider = "node node_modules/prisma-nestjs-graphql"
  output   = "../src/@generated"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
}

enum Status {
  PENDING
  ACCEPTED
  REJECTED
  CANCELED
}

model User {
  id                     String   @id @default(cuid())
  firstName              String
  lastName               String
  email                  String   @unique
  password               String
  phoneNumber            String   @unique
  imgSrc                 String?
  roles                  Role[]   @default([USER])
  friendRequestsSent     FriendRequest[] @relation("SentFriendRequests")
  friendRequestsReceived FriendRequest[] @relation("ReceivedFriendRequests")
}

model FriendRequest {
  id          String  @id @default(cuid())
  requesterId String
  receiverId  String
  requester   User    @relation("SentFriendRequests", fields: [requesterId], references: [id])
  receiver    User    @relation("ReceivedFriendRequests", fields: [receiverId], references: [id])
  status      Status  @default(PENDING)

  @@unique([requesterId, receiverId])
}